<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>上传管理</title>
<!-- 导入jquery核心类库 -->
<script type="text/javascript"
	src="${pageContext.request.contextPath }/js/jquery-1.8.3.js"></script>
<!-- css初始化文件 -->	
	<link rel="stylesheet" href="css/normalize.css">
<!-- css公共文件 -->	
	<link rel="stylesheet" href="css/manage.css">
<script type="text/javascript">
$(function(){
	var currentPage;
	if(!currentPage){
		currentPage = 1;
	}
	var tatalPage;
	var pageSize;
	
	$.ajax({                 /*页面初始加载到第一页 */
        type: "post",
        url: '${pageContext.request.contextPath}/desPartAction_page.action',
        data: {pageSize: 5, currentPage: 1},
        success: function (result) {
			tohtml(result);
        }
    });
	
	function tohtml(jdata){          /* 拼接表格数据的html */
    	$(".content").empty();
        var res = eval(jdata);
        var items = res.rows;          //jason数组中取要显示的表格数据
        pageSize = res.pageSize;       //每页大小
        currentPage = res.currentPage;   //当前页
        totalPage = Math.ceil(res.total / res.pageSize);   //计算总页数
        var content = '';
        content += '<table id="generatedTable"><tr><th>序号</th><th>零件名</th><th>图纸</th><th>描述</th><th>创建者</th><th>状态</th><th>创建时间</th></tr>';
        for (var i = 0; i < items.length; i++) {
            content += '<tr><td>' + items[i].id + '</td><td>' + items[i].name + '</td><td>' + items[i].drawing + 
            '</td><td>' + items[i].descb + '</td><td>' + items[i].creater + '</td><td>' + items[i].sta + 
            '</td><td>' + items[i].time + '</td></tr>';
        }
        content += '</table>'; 
        $(".content").append(content);
	};
	
	//首页
	$("#firstPage").on("click",function(){
		$.ajax({
	        type: "post",
	        url: '${pageContext.request.contextPath}/desPartAction_page.action',
	        data: {pageSize: 5, currentPage: 1},
	        success: function (result) {
				tohtml(result);
	        }
	    });	

	});
	
	//下一页
	$("#nextPage").on("click",function(){
		if(currentPage == totalPage){
            alert("已经是最后一页数据");
            return
        }else{
    		$.ajax({
    	        type: "post",
    	        url: '${pageContext.request.contextPath}/desPartAction_page.action',
    	        data: {pageSize: 5, currentPage: currentPage+1},
    	        success: function (result) {
    				tohtml(result);
    	        }
    		});        	  
        }
	});
	
	//上一页
	$("#previousPage").on("click",function(){
		$.ajax({
	        type: "post",
	        url: '${pageContext.request.contextPath}/desPartAction_page.action',
	        data: {pageSize: 5, currentPage: currentPage-1},
	        success: function (result) {
				tohtml(result);
	        }
		});
	});
	
	//最后一页
	$("#lastPage").on("click",function(){
		$.ajax({
	        type: "post",
	        url: '${pageContext.request.contextPath}/desPartAction_page.action',
	        data: {pageSize: 5, currentPage: totalPage},
	        success: function (result) {
				tohtml(result);
	        }
		});
	});
	
});
</script>
</head>
<body>
	<div class ="pager">
		<a href="javascript:void(0)" id="firstPage" >首页</a>
		<a href="javascript:void(0)" id="previousPage" >上一页</a>
		<a href="javascript:void(0)" id="nextPage" >下一页</a>
		<a href="javascript:void(0)" id="lastPage" >尾页</a>
	</div>
<!-- 	<div class="pager-info">
         当前页数：<span>$!pager.currentPage</span>
         总记录数：<span>$!pager.totalRecord</span>
         总记页数：<span>$!pager.totalPage</span>
	</div> -->
	</div>
	<div class="content"></div>
</body>
</html>