<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>产品列表</title>

    <script type="text/javascript" src="../js/jquery-1.8.3.js"></script>
    <link rel="stylesheet" href="../css/base.css">
    <script src="../js/three.js"></script>
    <script src="../js/STLLoader.js"></script>
    <script src="../js/TrackballControls.js"></script>
    <script src="../js/Detector.js"></script>
</head>

<script>
    var currentPage;
    if (!currentPage) {
        currentPage = 1;
    }
    var totalPage;
    var pageSize;
    /*页面初始加载到第一页 */
    despart(5, 1, tohtml);


    //首页
    function first() {
        despart(5, 1, tohtml);
    };

    //下一页
    function next() {
        if (currentPage == totalPage) {
            alert("已经是最后一页");
            return
        } else {
            despart(5, currentPage + 1, tohtml);
        }
    }

    //上一页
    function before() {
        if (currentPage == 1) {
            alert("已经是第一页");
            return
        } else {
            despart(5, currentPage - 1, tohtml);
        }
    };

    //最后一页
    function last() {
        despart(5, totalPage, tohtml);
    };


    function despart(pagesize, currentpage, tohtml) {
    	pageSize = pagesize;
    	currentPage = currentpage;
        $.ajax({ /* 页面初始加载到第一页 */
            type: "post",
            url: '../json/productlist_screw.json',
            data: {},
            success: function (result) {
                tohtml(result);
            }
        });
    }

    function tohtml(jdata) {          /* 拼接表格数据的html */
        $(".contentTab").empty();
        var res = eval(jdata);
        var items = res.rows;          //jason数组中取要显示的表格数据
        var firstResult = (currentPage - 1) * pageSize;
        totalPage = Math.ceil(res.total / pageSize);   //计算总页数
        var content = '';
        content += '<table id="generatedTable"><tr><th>序号</th><th>BN - 标准</th><th>描述</th><th>材质</th><th>强度等级</th><th>表面处理</th><th>图纸</th></tr>';
        for (var i = firstResult; i < firstResult+pageSize; i++) {
            content += '<tr><td>' + (i+1) + '</td><td>' + items[i].bnstandard +
                '</td><td>' + items[i].descb + '</td><td>' + items[i].material + '</td><td>' + items[i].hardness +
                '</td><td>' + items[i].surface + '</td><td>' + '<a class="cadview" data-type="" href="javascript:view3d();" data-url="1111111">' +
                '<img alt="" id="ImageCADViewer" src="../images/cad_icon.gif" title="' + items[i].drawing + '" /></a>' + '</td></tr>';
        }
        content += '</table>';
        $(".contentTab").append(content);
        $("#pageState").html(currentPage + '/' + totalPage);
    };

    //查看图形预览窗口
    function view3d() {
        $('#light').show();
        $('#fade').show();
        $('.viewbox').empty();
        $('.viewbox').load("./view3d.html");

    }
    //关闭图形预览窗口
    function closeview() {
        $('.viewbox').empty();
        $('#light').hide();
        $('#fade').hide();
    }
</script>

<body>
	<div class="productLeftNav">
        <div class="leftNav">
            产品列表
        </div>
        <div class="leftNavList">
            <ul>
                <li><a>防松螺母</a></li>
                <li><a>防松螺钉</a></li>
                <li><a>防松垫圈</a></li>
                <li><a>防松铆钉</a></li>
            </ul>
        </div>
	</div>
    <div class="pager">
        <a href="javascript:first()" id="firstPage">首页</a>
        <a href="javascript:before()" id="previousPage">上一页</a>
        <span>当前</span>
        <sapn id="pageState"></sapn>
        <span>页</span>
        <a href="javascript:next()" id="nextPage">下一页</a>
        <a href="javascript:last()" id="lastPage">尾页</a>
    </div>
    <div id="light" class="white_content">
        <div class="viewclose">
            <a href="javascript:closeview()">关闭</a>
        </div>
        <div class="viewbox"></div>
    </div>
    <div id="fade" class="black_overlay"></div>

    <div class="contentTab"></div>
</body>

</html>